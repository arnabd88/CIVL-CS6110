\hypertarget{strassen_8h}{}\section{/home/arnabd/workspace/civl/trunk/examples/omp/m4ri/m4ri/strassen.h File Reference}
\label{strassen_8h}\index{/home/arnabd/workspace/civl/trunk/examples/omp/m4ri/m4ri/strassen.\+h@{/home/arnabd/workspace/civl/trunk/examples/omp/m4ri/m4ri/strassen.\+h}}


Matrix operations using Strassen\textquotesingle{}s formulas including Winograd\textquotesingle{}s improvements.  


{\ttfamily \#include $<$math.\+h$>$}\\*
{\ttfamily \#include $<$m4ri/mzd.\+h$>$}\\*
{\ttfamily \#include $<$m4ri/brilliantrussian.\+h$>$}\\*
Include dependency graph for strassen.\+h\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{strassen_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=206pt]{strassen_8h__dep__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{strassen_8h_a574fda6cd10fea803ec5b211dbcac4bc}{\+\_\+\+\_\+\+M4\+R\+I\+\_\+\+S\+T\+R\+A\+S\+S\+E\+N\+\_\+\+M\+U\+L\+\_\+\+C\+U\+T\+O\+F\+F}~\hyperlink{misc_8h_a74e75242132eaabbc1c512488a135926}{M\+I\+N}(((int)sqrt((double)(4 $\ast$ \+\_\+\+\_\+\+M4\+R\+I\+\_\+\+C\+P\+U\+\_\+\+L3\+\_\+\+C\+A\+C\+H\+E))), 4096)
\begin{DoxyCompactList}\small\item\em The default cutoff for Strassen-\/\+Winograd multiplication. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{structmzd__t}{mzd\+\_\+t} $\ast$ \hyperlink{strassen_8h_a7032dd2b60b0cfc9a8c4dd2faddf5065}{mzd\+\_\+mul} (\hyperlink{structmzd__t}{mzd\+\_\+t} $\ast$C, \hyperlink{structmzd__t}{mzd\+\_\+t} const $\ast$\hyperlink{structA}{A}, \hyperlink{structmzd__t}{mzd\+\_\+t} const $\ast$B, int cutoff)
\begin{DoxyCompactList}\small\item\em Matrix multiplication via the Strassen-\/\+Winograd matrix multiplication algorithm, i.\+e. \end{DoxyCompactList}\item 
\hyperlink{structmzd__t}{mzd\+\_\+t} $\ast$ \hyperlink{strassen_8h_a2dd6c4982d73d9d27c01d3b0f9249304}{mzd\+\_\+addmul} (\hyperlink{structmzd__t}{mzd\+\_\+t} $\ast$C, \hyperlink{structmzd__t}{mzd\+\_\+t} const $\ast$\hyperlink{structA}{A}, \hyperlink{structmzd__t}{mzd\+\_\+t} const $\ast$B, int cutoff)
\begin{DoxyCompactList}\small\item\em Matrix multiplication and in-\/place addition via the Strassen-\/\+Winograd matrix multiplication algorithm, i.\+e. \end{DoxyCompactList}\item 
\hyperlink{structmzd__t}{mzd\+\_\+t} $\ast$ \hyperlink{strassen_8h_a8432a43d231b2aeaf118d21b35d817ce}{\+\_\+mzd\+\_\+mul\+\_\+even} (\hyperlink{structmzd__t}{mzd\+\_\+t} $\ast$C, \hyperlink{structmzd__t}{mzd\+\_\+t} const $\ast$\hyperlink{structA}{A}, \hyperlink{structmzd__t}{mzd\+\_\+t} const $\ast$B, int cutoff)
\begin{DoxyCompactList}\small\item\em Matrix multiplication via the Strassen-\/\+Winograd matrix multiplication algorithm, i.\+e. \end{DoxyCompactList}\item 
\hyperlink{structmzd__t}{mzd\+\_\+t} $\ast$ \hyperlink{strassen_8h_a6ad9c4c4d3ab2ec65f610a17d66cebb0}{\+\_\+mzd\+\_\+addmul\+\_\+even} (\hyperlink{structmzd__t}{mzd\+\_\+t} $\ast$C, \hyperlink{structmzd__t}{mzd\+\_\+t} const $\ast$\hyperlink{structA}{A}, \hyperlink{structmzd__t}{mzd\+\_\+t} const $\ast$B, int cutoff)
\begin{DoxyCompactList}\small\item\em Matrix multiplication and in-\/place addition via the Strassen-\/\+Winograd matrix multiplication algorithm, i.\+e. \end{DoxyCompactList}\item 
\hyperlink{structmzd__t}{mzd\+\_\+t} $\ast$ \hyperlink{strassen_8h_a9d3535d8c88c5182a494bbe3d47fdde7}{\+\_\+mzd\+\_\+addmul} (\hyperlink{structmzd__t}{mzd\+\_\+t} $\ast$C, \hyperlink{structmzd__t}{mzd\+\_\+t} const $\ast$\hyperlink{structA}{A}, \hyperlink{structmzd__t}{mzd\+\_\+t} const $\ast$B, int cutoff)
\begin{DoxyCompactList}\small\item\em Matrix multiplication and in-\/place addition via the Strassen-\/\+Winograd matrix multiplication algorithm, i.\+e. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Matrix operations using Strassen\textquotesingle{}s formulas including Winograd\textquotesingle{}s improvements. 

\begin{DoxyAuthor}{Author}
Gregory Bard \href{mailto:bard@fordham.edu}{\tt bard@fordham.\+edu} 

Martin Albrecht \href{mailto:M.R.Albrecht@rhul.ac.uk}{\tt M.\+R.\+Albrecht@rhul.\+ac.\+uk} 
\end{DoxyAuthor}


\subsection{Macro Definition Documentation}
\hypertarget{strassen_8h_a574fda6cd10fea803ec5b211dbcac4bc}{}\index{strassen.\+h@{strassen.\+h}!\+\_\+\+\_\+\+M4\+R\+I\+\_\+\+S\+T\+R\+A\+S\+S\+E\+N\+\_\+\+M\+U\+L\+\_\+\+C\+U\+T\+O\+F\+F@{\+\_\+\+\_\+\+M4\+R\+I\+\_\+\+S\+T\+R\+A\+S\+S\+E\+N\+\_\+\+M\+U\+L\+\_\+\+C\+U\+T\+O\+F\+F}}
\index{\+\_\+\+\_\+\+M4\+R\+I\+\_\+\+S\+T\+R\+A\+S\+S\+E\+N\+\_\+\+M\+U\+L\+\_\+\+C\+U\+T\+O\+F\+F@{\+\_\+\+\_\+\+M4\+R\+I\+\_\+\+S\+T\+R\+A\+S\+S\+E\+N\+\_\+\+M\+U\+L\+\_\+\+C\+U\+T\+O\+F\+F}!strassen.\+h@{strassen.\+h}}
\subsubsection[{\+\_\+\+\_\+\+M4\+R\+I\+\_\+\+S\+T\+R\+A\+S\+S\+E\+N\+\_\+\+M\+U\+L\+\_\+\+C\+U\+T\+O\+F\+F}]{\setlength{\rightskip}{0pt plus 5cm}\#define \+\_\+\+\_\+\+M4\+R\+I\+\_\+\+S\+T\+R\+A\+S\+S\+E\+N\+\_\+\+M\+U\+L\+\_\+\+C\+U\+T\+O\+F\+F~{\bf M\+I\+N}(((int)sqrt((double)(4 $\ast$ \+\_\+\+\_\+\+M4\+R\+I\+\_\+\+C\+P\+U\+\_\+\+L3\+\_\+\+C\+A\+C\+H\+E))), 4096)}\label{strassen_8h_a574fda6cd10fea803ec5b211dbcac4bc}


The default cutoff for Strassen-\/\+Winograd multiplication. 

It should hold hold that 2 $\ast$ (n$^\wedge$2)/8 fits into the L2 cache. 

\subsection{Function Documentation}
\hypertarget{strassen_8h_a9d3535d8c88c5182a494bbe3d47fdde7}{}\index{strassen.\+h@{strassen.\+h}!\+\_\+mzd\+\_\+addmul@{\+\_\+mzd\+\_\+addmul}}
\index{\+\_\+mzd\+\_\+addmul@{\+\_\+mzd\+\_\+addmul}!strassen.\+h@{strassen.\+h}}
\subsubsection[{\+\_\+mzd\+\_\+addmul}]{\setlength{\rightskip}{0pt plus 5cm}{\bf mzd\+\_\+t}$\ast$ \+\_\+mzd\+\_\+addmul (
\begin{DoxyParamCaption}
\item[{{\bf mzd\+\_\+t} $\ast$}]{C, }
\item[{{\bf mzd\+\_\+t} const $\ast$}]{A, }
\item[{{\bf mzd\+\_\+t} const $\ast$}]{B, }
\item[{int}]{cutoff}
\end{DoxyParamCaption}
)}\label{strassen_8h_a9d3535d8c88c5182a494bbe3d47fdde7}


Matrix multiplication and in-\/place addition via the Strassen-\/\+Winograd matrix multiplication algorithm, i.\+e. 

compute C = C + A\+B.

The matrices \hyperlink{structA}{A} and B are respectively m x k and k x n, and can be not aligned on the m4ri\+\_\+radix grid.


\begin{DoxyParams}{Parameters}
{\em C} & Preallocated product matrix, may be N\+U\+L\+L for automatic creation. \\
\hline
{\em \hyperlink{structA}{A}} & Input matrix \hyperlink{structA}{A} \\
\hline
{\em B} & Input matrix B \\
\hline
{\em cutoff} & Minimal dimension for Strassen recursion. \\
\hline
\end{DoxyParams}
Assumes that B and C are aligned in the same manner (as in a Schur complement)\hypertarget{strassen_8h_a6ad9c4c4d3ab2ec65f610a17d66cebb0}{}\index{strassen.\+h@{strassen.\+h}!\+\_\+mzd\+\_\+addmul\+\_\+even@{\+\_\+mzd\+\_\+addmul\+\_\+even}}
\index{\+\_\+mzd\+\_\+addmul\+\_\+even@{\+\_\+mzd\+\_\+addmul\+\_\+even}!strassen.\+h@{strassen.\+h}}
\subsubsection[{\+\_\+mzd\+\_\+addmul\+\_\+even}]{\setlength{\rightskip}{0pt plus 5cm}{\bf mzd\+\_\+t}$\ast$ \+\_\+mzd\+\_\+addmul\+\_\+even (
\begin{DoxyParamCaption}
\item[{{\bf mzd\+\_\+t} $\ast$}]{C, }
\item[{{\bf mzd\+\_\+t} const $\ast$}]{A, }
\item[{{\bf mzd\+\_\+t} const $\ast$}]{B, }
\item[{int}]{cutoff}
\end{DoxyParamCaption}
)}\label{strassen_8h_a6ad9c4c4d3ab2ec65f610a17d66cebb0}


Matrix multiplication and in-\/place addition via the Strassen-\/\+Winograd matrix multiplication algorithm, i.\+e. 

compute C = C+ A\+B.

This is the actual implementation. Any matrix where either the number of rows or the number of columns is smaller than cutoff is processed using the M4\+R\+M algorithm.


\begin{DoxyParams}{Parameters}
{\em C} & Preallocated product matrix, may be N\+U\+L\+L for automatic creation. \\
\hline
{\em \hyperlink{structA}{A}} & Input matrix \hyperlink{structA}{A} \\
\hline
{\em B} & Input matrix B \\
\hline
{\em cutoff} & Minimal dimension for Strassen recursion.\\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
This implementation is heavily inspired by the function strassen\+\_\+window\+\_\+multiply\+\_\+c in Sage 3.\+0; For reference see \href{http://www.sagemath.org}{\tt http\+://www.\+sagemath.\+org} 
\end{DoxyNote}
\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000012}{Todo}]make sure not to overwrite crap after ncols and before width $\ast$ m4ri\+\_\+radix \end{DoxyRefDesc}


\begin{DoxyNote}{Note}
See Marco Bodrato; \char`\"{}\+A Strassen-\/like Matrix Multiplication
\+Suited for Squaring and Highest Power Computation\char`\"{}; \href{http://bodrato.it/papres/#CIVV2008}{\tt http\+://bodrato.\+it/papres/\#\+C\+I\+V\+V2008} for reference on the used sequence of operations.
\end{DoxyNote}
\hypertarget{strassen_8h_a8432a43d231b2aeaf118d21b35d817ce}{}\index{strassen.\+h@{strassen.\+h}!\+\_\+mzd\+\_\+mul\+\_\+even@{\+\_\+mzd\+\_\+mul\+\_\+even}}
\index{\+\_\+mzd\+\_\+mul\+\_\+even@{\+\_\+mzd\+\_\+mul\+\_\+even}!strassen.\+h@{strassen.\+h}}
\subsubsection[{\+\_\+mzd\+\_\+mul\+\_\+even}]{\setlength{\rightskip}{0pt plus 5cm}{\bf mzd\+\_\+t}$\ast$ \+\_\+mzd\+\_\+mul\+\_\+even (
\begin{DoxyParamCaption}
\item[{{\bf mzd\+\_\+t} $\ast$}]{C, }
\item[{{\bf mzd\+\_\+t} const $\ast$}]{A, }
\item[{{\bf mzd\+\_\+t} const $\ast$}]{B, }
\item[{int}]{cutoff}
\end{DoxyParamCaption}
)}\label{strassen_8h_a8432a43d231b2aeaf118d21b35d817ce}


Matrix multiplication via the Strassen-\/\+Winograd matrix multiplication algorithm, i.\+e. 

compute C = A\+B.

This is the actual implementation. Any matrix where either the number of rows or the number of columns is smaller than cutoff is processed using the M4\+R\+M algorithm.


\begin{DoxyParams}{Parameters}
{\em C} & Preallocated product matrix, may be N\+U\+L\+L for automatic creation. \\
\hline
{\em \hyperlink{structA}{A}} & Input matrix \hyperlink{structA}{A} \\
\hline
{\em B} & Input matrix B \\
\hline
{\em cutoff} & Minimal dimension for Strassen recursion.\\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
This implementation is heavily inspired by the function strassen\+\_\+window\+\_\+multiply\+\_\+c in Sage 3.\+0; For reference see \href{http://www.sagemath.org}{\tt http\+://www.\+sagemath.\+org} 
\end{DoxyNote}
\begin{DoxyNote}{Note}
See Marco Bodrato; \char`\"{}\+A Strassen-\/like Matrix Multiplication
\+Suited for Squaring and Highest Power Computation\char`\"{}; \href{http://bodrato.it/papres/#CIVV2008}{\tt http\+://bodrato.\+it/papres/\#\+C\+I\+V\+V2008} for reference on the used sequence of operations.
\end{DoxyNote}
\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000011}{Todo}]ideally we would use the same Wmk throughout the function but some called function doesn\textquotesingle{}t like that and we end up with a wrong result if we use virtual Wmk matrices. Ideally, this should be fixed not worked around. The check whether the bug has been fixed, use only one Wmk and check if mzd\+\_\+mul(4096, 3528, 4096, 2124) still returns the correct answer. \end{DoxyRefDesc}
\hypertarget{strassen_8h_a2dd6c4982d73d9d27c01d3b0f9249304}{}\index{strassen.\+h@{strassen.\+h}!mzd\+\_\+addmul@{mzd\+\_\+addmul}}
\index{mzd\+\_\+addmul@{mzd\+\_\+addmul}!strassen.\+h@{strassen.\+h}}
\subsubsection[{mzd\+\_\+addmul}]{\setlength{\rightskip}{0pt plus 5cm}{\bf mzd\+\_\+t}$\ast$ mzd\+\_\+addmul (
\begin{DoxyParamCaption}
\item[{{\bf mzd\+\_\+t} $\ast$}]{C, }
\item[{{\bf mzd\+\_\+t} const $\ast$}]{A, }
\item[{{\bf mzd\+\_\+t} const $\ast$}]{B, }
\item[{int}]{cutoff}
\end{DoxyParamCaption}
)}\label{strassen_8h_a2dd6c4982d73d9d27c01d3b0f9249304}


Matrix multiplication and in-\/place addition via the Strassen-\/\+Winograd matrix multiplication algorithm, i.\+e. 

compute C = C+ A\+B.

This is the wrapper function including bounds checks. See \+\_\+mzd\+\_\+addmul\+\_\+even for implementation details.


\begin{DoxyParams}{Parameters}
{\em C} & product matrix \\
\hline
{\em \hyperlink{structA}{A}} & Input matrix \hyperlink{structA}{A} \\
\hline
{\em B} & Input matrix B \\
\hline
{\em cutoff} & Minimal dimension for Strassen recursion. \\
\hline
\end{DoxyParams}
\hypertarget{strassen_8h_a7032dd2b60b0cfc9a8c4dd2faddf5065}{}\index{strassen.\+h@{strassen.\+h}!mzd\+\_\+mul@{mzd\+\_\+mul}}
\index{mzd\+\_\+mul@{mzd\+\_\+mul}!strassen.\+h@{strassen.\+h}}
\subsubsection[{mzd\+\_\+mul}]{\setlength{\rightskip}{0pt plus 5cm}{\bf mzd\+\_\+t}$\ast$ mzd\+\_\+mul (
\begin{DoxyParamCaption}
\item[{{\bf mzd\+\_\+t} $\ast$}]{C, }
\item[{{\bf mzd\+\_\+t} const $\ast$}]{A, }
\item[{{\bf mzd\+\_\+t} const $\ast$}]{B, }
\item[{int}]{cutoff}
\end{DoxyParamCaption}
)}\label{strassen_8h_a7032dd2b60b0cfc9a8c4dd2faddf5065}


Matrix multiplication via the Strassen-\/\+Winograd matrix multiplication algorithm, i.\+e. 

compute C = A\+B.

This is the wrapper function including bounds checks. See \+\_\+mzd\+\_\+mul\+\_\+even for implementation details.


\begin{DoxyParams}{Parameters}
{\em C} & Preallocated product matrix, may be N\+U\+L\+L for automatic creation. \\
\hline
{\em \hyperlink{structA}{A}} & Input matrix \hyperlink{structA}{A} \\
\hline
{\em B} & Input matrix B \\
\hline
{\em cutoff} & Minimal dimension for Strassen recursion. \\
\hline
\end{DoxyParams}
