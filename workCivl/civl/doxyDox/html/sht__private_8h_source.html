<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>My Project: /home/arnabd/workspace/civl/trunk/examples/omp/shtns/sht_private.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">My Project
   &#160;<span id="projectnumber">CIVL</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_4e3a55e2a9734425e24eb78aa4793941.html">trunk</a></li><li class="navelem"><a class="el" href="dir_64c63d8f40ff7415cd4ceaeda413fc87.html">examples</a></li><li class="navelem"><a class="el" href="dir_2e765961812122e1e15def7d2e5d6582.html">omp</a></li><li class="navelem"><a class="el" href="dir_b04bddefcb77eb38b43c30777187672a.html">shtns</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">sht_private.h</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Copyright (c) 2010-2015 Centre National de la Recherche Scientifique.</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * written by Nathanael Schaeffer (CNRS, ISTerre, Grenoble, France).</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * nathanael.schaeffer@ujf-grenoble.fr</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * This software is governed by the CeCILL license under French law and</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * abiding by the rules of distribution of free software. You can use,</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * modify and/or redistribute the software under the terms of the CeCILL</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * license as circulated by CEA, CNRS and INRIA at the following URL</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * &quot;http://www.cecill.info&quot;.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * The fact that you are presently reading this means that you have had</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * knowledge of the CeCILL license and that you accept its terms.</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">/********************************************************************</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * SHTns : Spherical Harmonic Transform for numerical simulations.  *</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> *    written by Nathanael Schaeffer / CNRS                         *</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> ********************************************************************/</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &lt;complex.h&gt;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">// FFTW la derivee d/dx = ik    (pas de moins !)</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;fftw3/fftw3.h&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">// config file generated by ./configure</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;sht_config.h&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#define SHTNS_PRIVATE</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="shtns_8h.html">shtns.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">  #include &lt;omp.h&gt;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">/* BEGIN COMPILE-TIME SETTINGS */</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#define SHTNS_MAX_MEMORY 2048</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#define MIN_PERF_IMPROVE_DCT 1.05</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#define MIN_ACCURACY_DCT 1.e-8</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#define SHT_DEFAULT_POLAR_OPT 1.e-10</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#define SHT_DEFAULT_NORM ( sht_orthonormal )</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">//#define SHT_DEFAULT_NORM ( sht_schmidt | SHT_NO_CS_PHASE )</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#define SHT_DEFAULT_NL_ORDER 1</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#define SHT_MIN_NLAT_DCT 64</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#define SHT_TIME_LIMIT 0.2</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">/* END COMPILE-TIME SETTINGS */</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">// sht variants (std, ltr)</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="keyword">enum</span> sht_variants { SHT_STD, SHT_LTR, SHT_M, SHT_NVAR };</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">// sht types (scal synth, scal analys, vect synth, ...)</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="keyword">enum</span> sht_types { SHT_TYP_SSY, SHT_TYP_SAN, SHT_TYP_VSY, SHT_TYP_VAN,</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    SHT_TYP_GSP, SHT_TYP_GTO, SHT_TYP_3SY, SHT_TYP_3AN, SHT_NTYP };</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">// sht grids</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="keyword">enum</span> sht_grids { GRID_NONE, GRID_GAUSS, GRID_REGULAR, GRID_POLES };</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">// pointer to various function types</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="keyword">typedef</span> void (*pf2l)(<a class="code" href="shtns_8h.html#ab7bd78e5cbeb4ed18782d018195fde00">shtns_cfg</a>, <span class="keywordtype">void</span>*, <span class="keywordtype">void</span>*, <span class="keywordtype">long</span> int);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="keyword">typedef</span> void (*pf3l)(<a class="code" href="shtns_8h.html#ab7bd78e5cbeb4ed18782d018195fde00">shtns_cfg</a>, <span class="keywordtype">void</span>*, <span class="keywordtype">void</span>*, <span class="keywordtype">void</span>*, <span class="keywordtype">long</span> int);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="keyword">typedef</span> void (*pf4l)(<a class="code" href="shtns_8h.html#ab7bd78e5cbeb4ed18782d018195fde00">shtns_cfg</a>, <span class="keywordtype">void</span>*, <span class="keywordtype">void</span>*, <span class="keywordtype">void</span>*, <span class="keywordtype">void</span>*, <span class="keywordtype">long</span> int);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="keyword">typedef</span> void (*pf6l)(<a class="code" href="shtns_8h.html#ab7bd78e5cbeb4ed18782d018195fde00">shtns_cfg</a>, <span class="keywordtype">void</span>*, <span class="keywordtype">void</span>*, <span class="keywordtype">void</span>*, <span class="keywordtype">void</span>*, <span class="keywordtype">void</span>*, <span class="keywordtype">void</span>*, <span class="keywordtype">long</span> int);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="keyword">typedef</span> void (*pf2ml)(<a class="code" href="shtns_8h.html#ab7bd78e5cbeb4ed18782d018195fde00">shtns_cfg</a>, int, <span class="keywordtype">void</span>*, <span class="keywordtype">void</span>*, <span class="keywordtype">long</span> int);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="keyword">typedef</span> void (*pf3ml)(<a class="code" href="shtns_8h.html#ab7bd78e5cbeb4ed18782d018195fde00">shtns_cfg</a>, int, <span class="keywordtype">void</span>*, <span class="keywordtype">void</span>*, <span class="keywordtype">void</span>*, <span class="keywordtype">long</span> int);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="keyword">typedef</span> void (*pf4ml)(<a class="code" href="shtns_8h.html#ab7bd78e5cbeb4ed18782d018195fde00">shtns_cfg</a>, int, <span class="keywordtype">void</span>*, <span class="keywordtype">void</span>*, <span class="keywordtype">void</span>*, <span class="keywordtype">void</span>*, <span class="keywordtype">long</span> int);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="keyword">typedef</span> void (*pf6ml)(<a class="code" href="shtns_8h.html#ab7bd78e5cbeb4ed18782d018195fde00">shtns_cfg</a>, int, <span class="keywordtype">void</span>*, <span class="keywordtype">void</span>*, <span class="keywordtype">void</span>*, <span class="keywordtype">void</span>*, <span class="keywordtype">void</span>*, <span class="keywordtype">void</span>*, <span class="keywordtype">long</span> int);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="structshtns__info.html">   93</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structshtns__info.html">shtns_info</a> {     <span class="comment">// MUST start with &quot;int nlm;&quot;</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">/* PUBLIC PART (if modified, shtns.h should be modified acordingly) */</span></div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="structshtns__info.html#abd15108a5e4f0687f42a67b1b64a9a47">   95</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structshtns__info.html#abd15108a5e4f0687f42a67b1b64a9a47">nlm</a>;           </div>
<div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="structshtns__info.html#a8a5c45a1fd2227abb668a3b3a4259509">   96</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="structshtns__info.html#a8a5c45a1fd2227abb668a3b3a4259509">lmax</a>;        </div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="structshtns__info.html#a38cd0b51312d467b68c2de264b66997b">   97</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="structshtns__info.html#a38cd0b51312d467b68c2de264b66997b">mmax</a>;        </div>
<div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="structshtns__info.html#aecf1d8b5744c247e04a0318136390a58">   98</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="structshtns__info.html#aecf1d8b5744c247e04a0318136390a58">mres</a>;        </div>
<div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="structshtns__info.html#a4e3a22a9dff6a9cf670fc007fb974a7c">   99</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="structshtns__info.html#a4e3a22a9dff6a9cf670fc007fb974a7c">nphi</a>;        </div>
<div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="structshtns__info.html#a12475937302f111720d59b8b11424215">  100</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="structshtns__info.html#a12475937302f111720d59b8b11424215">nlat</a>;        </div>
<div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="structshtns__info.html#ae333643489525b49fd066ba7bb638696">  101</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="structshtns__info.html#ae333643489525b49fd066ba7bb638696">nlat_2</a>;      </div>
<div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="structshtns__info.html#ad14521718bc234a2197e2d7bb91e0e81">  102</a></span>&#160;    <span class="keywordtype">int</span> *<a class="code" href="structshtns__info.html#ad14521718bc234a2197e2d7bb91e0e81">lmidx</a>;                 </div>
<div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="structshtns__info.html#ae51719912d1a0c6ce672441e9931a574">  103</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *<a class="code" href="structshtns__info.html#ae51719912d1a0c6ce672441e9931a574">li</a>;         </div>
<div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="structshtns__info.html#a296b42387b5b60f6f4873a7024cd0d5d">  104</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *<a class="code" href="structshtns__info.html#a296b42387b5b60f6f4873a7024cd0d5d">mi</a>;         </div>
<div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="structshtns__info.html#a609589277af64939f7011b669147617b">  105</a></span>&#160;    <span class="keywordtype">double</span> *ct, *<a class="code" href="structshtns__info.html#a609589277af64939f7011b669147617b">st</a>;            </div>
<div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="structshtns__info.html#aed9bef40a200b6930120b84fa130c41a">  106</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structshtns__info.html#aed9bef40a200b6930120b84fa130c41a">nspat</a>;         </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">/* END OF PUBLIC PART */</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div>
<div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="structshtns__info.html#a2b76f5aee91ca7a93387d087ece0fd99">  109</a></span>&#160;    <span class="keywordtype">short</span> <a class="code" href="structshtns__info.html#a2b76f5aee91ca7a93387d087ece0fd99">fftc_mode</a>;            </div>
<div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="structshtns__info.html#a15f3351973710815ee68d0369e48dc43">  110</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="structshtns__info.html#a15f3351973710815ee68d0369e48dc43">nthreads</a>;    </div>
<div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="structshtns__info.html#a6e82a42d5e69391830bf5d7f085333f7">  111</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *<a class="code" href="structshtns__info.html#a6e82a42d5e69391830bf5d7f085333f7">tm</a>;         </div>
<div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="structshtns__info.html#a87e19b6bc65bf3d76cec4432d07bd3ff">  112</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structshtns__info.html#a87e19b6bc65bf3d76cec4432d07bd3ff">k_stride_a</a>;             </div>
<div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="structshtns__info.html#ac77e4275a0d03ef91cf9c9329eca6911">  113</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structshtns__info.html#ac77e4275a0d03ef91cf9c9329eca6911">m_stride_a</a>;             </div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="structshtns__info.html#afa549ef135b12b5060b2afecc1f9e660">  114</a></span>&#160;    <span class="keywordtype">double</span> *<a class="code" href="structshtns__info.html#afa549ef135b12b5060b2afecc1f9e660">wg</a>;                 </div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="structshtns__info.html#a646d0d38ed4bb1349d5cb5111b66e114">  115</a></span>&#160;    <span class="keywordtype">double</span> *<a class="code" href="structshtns__info.html#a646d0d38ed4bb1349d5cb5111b66e114">st_1</a>;               </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    fftw_plan ifft, fft;        <span class="comment">// plans for FFTW.</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    fftw_plan ifftc, fftc;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="comment">/* Legendre function generation arrays */</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordtype">double</span> *alm;    <span class="comment">// coefficient list for Legendre function recurrence (size 2*NLM)</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordtype">double</span> *blm;    <span class="comment">// coefficient list for modified Legendre function recurrence for analysis (size 2*NLM)</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordtype">double</span> *l_2;    <span class="comment">// array of size (LMAX+1) containing 1./l(l+1) for increasing integer l.</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordtype">void</span>* ftable[SHT_NVAR][SHT_NTYP];       <span class="comment">// pointers to transform functions.</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">/* MEM matrices */</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordtype">double</span> **ylm;       <span class="comment">// matrix for inverse transform (synthesis)</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keyword">struct </span><a class="code" href="structDtDp.html">DtDp</a>** dylm; <span class="comment">// theta and phi derivative of Ylm matrix</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordtype">double</span> **zlm;       <span class="comment">// matrix for direct transform (analysis)</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keyword">struct </span><a class="code" href="structDtDp.html">DtDp</a>** dzlm;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="structshtns__info.html#a30fd69b66eeb67e111ef1689bfb2d549">  133</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structshtns__info.html#a30fd69b66eeb67e111ef1689bfb2d549">ncplx_fft</a>;          </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="comment">/* DCT stuff */</span></div>
<div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="structshtns__info.html#afacdb118d7b598332508ca8cfa914e15">  136</a></span>&#160;    <span class="keywordtype">short</span> <a class="code" href="structshtns__info.html#afacdb118d7b598332508ca8cfa914e15">mtr_dct</a>;          </div>
<div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="structshtns__info.html#ad09115673d1275202501773f5a9f4875">  137</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="structshtns__info.html#ad09115673d1275202501773f5a9f4875">klim</a>;    </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    fftw_plan idct, dct_m0;         <span class="comment">// (I)DCT</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordtype">double</span> **ykm_dct;   <span class="comment">// matrix for inverse transform (synthesis) using dct.</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keyword">struct </span><a class="code" href="structDtDp.html">DtDp</a>** dykm_dct; <span class="comment">// theta and phi derivative of Ykm matrix.</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordtype">double</span> *zlm_dct0;   <span class="comment">// matrix for direct transform (analysis), only m=0</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordtype">double</span> *dzlm_dct0;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">/* other misc informations */</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> nlorder;  <span class="comment">// order of non-linear terms to be resolved by SH transform.</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> grid;     <span class="comment">// store grid type.</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordtype">short</span> norm;             <span class="comment">// store the normalization of the Spherical Harmonics (enum \ref shtns_norm + \ref SHT_NO_CS_PHASE flag)</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordtype">unsigned</span> fftw_plan_mode;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordtype">double</span> Y00_1, Y10_ct, Y11_st;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <a class="code" href="structshtns__info.html">shtns_cfg</a> next;     <span class="comment">// pointer to next sht_setup or NULL (records a chained list of SHT setup).</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="comment">// the end should be aligned on the size of int, to allow the storage of small arrays.</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;};</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">// define shortcuts to sizes.</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="preprocessor">#define NLM shtns-&gt;nlm</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="preprocessor">#define LMAX shtns-&gt;lmax</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="preprocessor">#define NLAT shtns-&gt;nlat</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="preprocessor">#define NLAT_2 shtns-&gt;nlat_2</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="preprocessor">#define NPHI shtns-&gt;nphi</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="preprocessor">#define MMAX shtns-&gt;mmax</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="preprocessor">#define MRES shtns-&gt;mres</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="preprocessor">#define MTR_DCT shtns-&gt;mtr_dct</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="preprocessor">#define SHT_NL_ORDER shtns-&gt;nlorder</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">// define index in alm/blm matrices</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="preprocessor">#define ALM_IDX(shtns, im) ( (im)*(2*shtns-&gt;lmax - ((im)-1)*shtns-&gt;mres) )</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">// SHT_NORM without CS_PHASE</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="preprocessor">#define SHT_NORM (shtns-&gt;norm &amp; 0x0FF)</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="preprocessor">#ifndef M_PI</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="preprocessor"># define M_PI 3.1415926535897932384626433832795</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="preprocessor">#ifndef M_PIl</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="preprocessor"># define M_PIl 3.1415926535897932384626433832795L</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">// value for on-the-fly transforms is lower because it allows to optimize some more (don&#39;t compute l which are not significant).</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="preprocessor">#define SHT_L_RESCALE_FLY 1000</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">// set to a value close to the machine accuracy, it allows to speed-up on-the-fly SHTs with very large l (lmax &gt; SHT_L_RESCALE_FLY).</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="preprocessor">#define SHT_ACCURACY 1.0e-20</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">// scale factor for extended range numbers (used in on-the-fly transforms to compute recurrence)</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="preprocessor">#define SHT_SCALE_FACTOR 2.9073548971824275622e+135</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">//#define SHT_SCALE_FACTOR 2.0370359763344860863e+90</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="preprocessor">#if _GCC_VEC_ == 0</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="preprocessor">    #undef _GCC_VEC_</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">/* are there vector extensions available ? */</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="preprocessor">#if !(defined __SSE2__ || defined __MIC__ || defined __VECTOR4DOUBLE__)</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="preprocessor">    #undef _GCC_VEC_</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="preprocessor">#ifdef __INTEL_COMPILER</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="preprocessor">    #if __INTEL_COMPILER &lt; 1400</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="preprocessor">        #undef _GCC_VEC_</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="preprocessor">        #warning &quot;no vector extensions available ! use gcc 4+ or icc 14+ for best performance.&quot;</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="preprocessor">#ifdef __GNUC__</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="preprocessor">    #if __GNUC__ &lt; 4</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="preprocessor">        #undef _GCC_VEC_</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="preprocessor">        #warning &quot;no vector extensions available ! use gcc 4+ or icc 14+ for best performance.&quot;</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="preprocessor">#if _GCC_VEC_ &amp;&amp; __VECTOR4DOUBLE__</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">// support Blue Gene/Q QPX vectors</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="preprocessor">    #define MIN_ALIGNMENT 32</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="preprocessor">    #define VSIZE 2</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structcomplex.html">complex</a> <span class="keywordtype">double</span> v2d __attribute__((aligned (16)));       <span class="comment">// vector that contains a complex number</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keyword">typedef</span> <span class="keywordtype">double</span> s2d __attribute__((aligned (16)));       <span class="comment">// scalar number</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="preprocessor">    #define VSIZE2 4</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="preprocessor">    #define _SIMD_NAME_ &quot;qpx&quot;</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keyword">typedef</span> vector4double rnd;      <span class="comment">// vector of 4 doubles.</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="preprocessor">    #define vall(x) vec_splats(x)</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="preprocessor">    #define vread(mem, idx) vec_lda((idx)*32, ((double*)mem))</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="preprocessor">    #define vstor(mem, idx, v) vec_sta(v, (idx)*32, ((double*)mem))</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">double</span> reduce_add(rnd a) {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        a += vec_perm(a, a, vec_gpci(02301));</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        a += vec_perm(a, a, vec_gpci(01032));</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="keywordflow">return</span>( a[0] );</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keyword">inline</span> <span class="keyword">static</span> v2d v2d_reduce(rnd a, rnd b) {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        a = vec_perm(a, b, vec_gpci(00426)) + vec_perm(a, b, vec_gpci(01537));</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        a += vec_perm(a, a, vec_gpci(02301));</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <span class="keywordflow">return</span> a[0] + I*a[1];</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="comment">//#define v2d_reduce(a, b) ( reduce_add(a) +I* reduce_add(b) )</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="preprocessor">    #define S2D_STORE(mem, idx, ev, od) \</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="preprocessor">        vstor(mem, idx, ev+od); \</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="preprocessor">        vstor((double*)mem + NLAT-VSIZE2 - (idx)*VSIZE2, 0, vec_perm(ev-od, ev-od, vec_gpci(03210)));</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="preprocessor">    #define S2D_CSTORE(mem, idx, er, or, ei, oi)    {   \</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="preprocessor">        rnd aa = vec_perm(ei+oi, ei+oi, vec_gpci(01032)) + (er+or); \</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="preprocessor">        rnd bb = (er + or) - vec_perm(ei+oi, ei+oi, vec_gpci(01032)); \</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="preprocessor">        vstor(mem, idx, vec_perm(bb, aa, vec_gpci(00527))); \</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="preprocessor">        vstor(((double*)mem) + (NPHI-2*im)*NLAT, idx, vec_perm(aa, bb, vec_gpci(00527))); \</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="preprocessor">        aa = vec_perm(er-or, er-or, vec_gpci(01032)) + (ei-oi); \</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="preprocessor">        bb = vec_perm(er-or, er-or, vec_gpci(01032)) - (ei-oi); \</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="preprocessor">        vstor(((double*)mem) + NLAT, -(idx+1), vec_perm(bb, aa, vec_gpci(02705))); \</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="preprocessor">        vstor(((double*)mem) + (NPHI+1-2*im)*NLAT, -(idx+1), vec_perm(aa, bb, vec_gpci(02705))); }</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="comment">// TODO: S2D_CSTORE2 has not been tested and is probably wrong...</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="preprocessor">    #define S2D_CSTORE2(mem, idx, er, or, ei, oi)   {   \</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="preprocessor">        rnd aa = vec_perm(er+or, ei+oi, vec_gpci(00415)); \</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="preprocessor">        rnd bb = vec_perm(er+or, ei+oi, vec_gpci(02637)); \</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="preprocessor">        vstor(mem, idx*2, aa); \</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="preprocessor">        vstor(mem, idx*2+1, bb); \</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="preprocessor">        aa = vec_perm(er-or, ei-oi, vec_gpci(00415)); \</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="preprocessor">        bb = vec_perm(er-or, ei-oi, vec_gpci(02637)); \</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="preprocessor">        vstor(mem, NLAT_2-1-idx*2, aa); \</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="preprocessor">        vstor(mem, NLAT_2-2-idx*2, bb); }</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="preprocessor">    #define vdup(x) (x)</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="preprocessor">    #define vlo(a) (a[0])</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="preprocessor">    #define vcplx_real(a) creal(a)</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="preprocessor">    #define vcplx_imag(a) cimag(a)</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">/*inline static void* VMALLOC(size_t s) {</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">        void* ptr;</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">        posix_memalign(&amp;ptr, MIN_ALIGNMENT, s);</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">        return ptr;</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">    }*/</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="preprocessor">    #define VMALLOC(s)  malloc(s)</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="preprocessor">    #define VFREE(s)    free(s)</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="preprocessor">#if _GCC_VEC_ &amp;&amp; __MIC__</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="comment">// these values must be adjusted for the larger vectors of the MIC</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="preprocessor">    #undef SHT_L_RESCALE_FLY</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="preprocessor">    #undef SHT_ACCURACY</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="preprocessor">    #define SHT_L_RESCALE_FLY 1800</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="preprocessor">    #define SHT_ACCURACY 1.0e-40</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="preprocessor">    #define MIN_ALIGNMENT 64</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="preprocessor">    #define VSIZE 2</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structcomplex.html">complex</a> <span class="keywordtype">double</span> v2d __attribute__((aligned (16)));       <span class="comment">// vector that contains a complex number</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keyword">typedef</span> <span class="keywordtype">double</span> s2d __attribute__((aligned (16)));       <span class="comment">// scalar number</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="preprocessor">    #define VSIZE2 8</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="preprocessor">    #include &lt;immintrin.h&gt;</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="preprocessor">    #define _SIMD_NAME_ &quot;mic&quot;</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keyword">typedef</span> <span class="keywordtype">double</span> rnd __attribute__ ((vector_size (VSIZE2*8)));        <span class="comment">// vector of 8 doubles.</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keyword">typedef</span> <span class="keyword">union </span>{ rnd i; <span class="keywordtype">double</span> v[8]; } vec_rnd;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="preprocessor">    #define vall(x) ((rnd) _mm512_set1_pd(x))</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keyword">inline</span> <span class="keyword">static</span> rnd vread(<span class="keywordtype">double</span> *mem, <span class="keywordtype">int</span> idx) {     <span class="comment">// unaligned load.</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        rnd t;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        t = (rnd)_mm512_loadunpacklo_pd( t, (mem) + (idx)*VSIZE2 );</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        t = (rnd)_mm512_loadunpackhi_pd( t, (mem) + (idx)*VSIZE2 + 64 );</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="keywordflow">return</span> t;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="preprocessor">    #define reduce_add(a) _mm512_reduce_add_pd(a)</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="preprocessor">    #define v2d_reduce(a, b) ( _mm512_reduce_add_pd(a) +I* _mm512_reduce_add_pd(b) )</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> vstor(<span class="keywordtype">double</span> *mem, <span class="keywordtype">int</span> idx, rnd v) {     <span class="comment">// unaligned store.</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        _mm512_packstorelo_pd((mem) + (idx)*VSIZE2, v);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        _mm512_packstorehi_pd((mem) + (idx)*VSIZE2 + 64, v);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    }</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="comment">// could be simplified with scatter</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="preprocessor">    #define S2D_STORE(mem, idx, ev, od) \</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="preprocessor">        _mm512_store_pd( (double*)mem + (idx)*VSIZE2,   ev+od); \</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="preprocessor">        _mm512_store_pd( (double*)mem + NLAT_2-VSIZE2 - (idx)*VSIZE2, \</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="preprocessor">                _mm512_castsi512_pd(_mm512_shuffle_epi32(_mm512_permute4f128_epi32(_mm512_castpd_si512(ev-od), _MM_PERM_ABCD),_MM_PERM_BADC)));</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="comment">// could be simplified with scatter</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="preprocessor">    #define S2D_CSTORE(mem, idx, er, or, ei, oi)    {       \</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="preprocessor">        rnd aa = (rnd)_mm512_castsi512_pd(_mm512_shuffle_epi32(_mm512_castpd_si512(ei+oi), _MM_PERM_BADC)); \</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="preprocessor">        rnd bb = (er + or) - aa; \</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="preprocessor">        aa += er + or; \</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="preprocessor">        _mm512_store_pd( (double*)mem + (idx)*VSIZE2, _mm512_mask_mov_pd(bb, 170, aa) ); \</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="preprocessor">        _mm512_store_pd( (double*)mem + (NPHI-VSIZE2*im)*NLAT_2 + (idx)*VSIZE2, _mm512_mask_mov_pd(aa, 170, bb) ); \</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="preprocessor">        aa = (rnd)_mm512_castsi512_pd(_mm512_shuffle_epi32( _mm512_castpd_si512(er-or), _MM_PERM_BADC )); \</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="preprocessor">        bb = aa - (ei - oi);    \</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="preprocessor">        aa += ei - oi; \</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="preprocessor">        _mm512_store_pd( (double*)mem + NLAT_2-VSIZE2 - (idx)*VSIZE2, \</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="preprocessor">                _mm512_castsi512_pd(_mm512_shuffle_epi32(_mm512_permute4f128_epi32(_mm512_castpd_si512(_mm512_mask_mov_pd(bb,170,aa)), _MM_PERM_ABCD),_MM_PERM_BADC))); \</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="preprocessor">        _mm512_store_pd( (double*)mem + (NPHI+1-2*im)*NLAT_2-VSIZE2 - (idx)*VSIZE2, \</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="preprocessor">                _mm512_castsi512_pd(_mm512_shuffle_epi32(_mm512_permute4f128_epi32(_mm512_castpd_si512(_mm512_mask_mov_pd(bb,170,aa)), _MM_PERM_ABCD),_MM_PERM_BADC))); }</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="preprocessor">    #define vdup(x) (x)</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="preprocessor">    #define vlo(a) ((vec_rnd)a).v[0]</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="preprocessor">    #define vcplx_real(a) creal(a)</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="preprocessor">    #define vcplx_imag(a) cimag(a)</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="preprocessor">    #define VMALLOC(s)  _mm_malloc(s, MIN_ALIGNMENT)</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="preprocessor">    #define VFREE(s)    _mm_free(s)</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="preprocessor">#if _GCC_VEC_ &amp;&amp; __SSE2__</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="preprocessor">    #define MIN_ALIGNMENT 16</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="preprocessor">    #define VSIZE 2</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keyword">typedef</span> <span class="keywordtype">double</span> s2d __attribute__ ((vector_size (8*VSIZE)));     <span class="comment">// vector that should behave like a real scalar for complex number multiplication.</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keyword">typedef</span> <span class="keywordtype">double</span> v2d __attribute__ ((vector_size (8*VSIZE)));     <span class="comment">// vector that contains a complex number</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="preprocessor">    #ifdef __AVX__</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="preprocessor">        #define VSIZE2 4</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="preprocessor">        #include &lt;immintrin.h&gt;</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="preprocessor">        #define _SIMD_NAME_ &quot;avx&quot;</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="keyword">typedef</span> <span class="keywordtype">double</span> rnd __attribute__ ((vector_size (VSIZE2*8)));        <span class="comment">// vector of 4 doubles.</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="preprocessor">        #define vall(x) ((rnd) _mm256_set1_pd(x))</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="preprocessor">        #define vread(mem, idx) ((rnd)_mm256_loadu_pd( ((double*)mem) + (idx)*4 ))</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="preprocessor">        #define vstor(mem, idx, v) _mm256_storeu_pd( ((double*)mem) + (idx)*4 , v)</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">double</span> reduce_add(rnd a) {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            v2d t = (v2d)_mm256_castpd256_pd128(a) + (v2d)_mm256_extractf128_pd(a,1);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            <span class="keywordflow">return</span> _mm_cvtsd_f64(t) + _mm_cvtsd_f64(_mm_unpackhi_pd(t,t));</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        }</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="keyword">inline</span> <span class="keyword">static</span> v2d v2d_reduce(rnd a, rnd b) {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            a = _mm256_hadd_pd(a, b);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            <span class="keywordflow">return</span> (v2d)_mm256_castpd256_pd128(a) + (v2d)_mm256_extractf128_pd(a,1);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="preprocessor">        #define S2D_STORE(mem, idx, ev, od) \</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="preprocessor">            _mm256_storeu_pd(((double*)mem) + (idx)*4,   ev+od); \</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="preprocessor">            ((s2d*)mem)[NLAT_2-1 - (idx)*2] = _mm256_castpd256_pd128(_mm256_shuffle_pd(ev-od, ev-od, 5)); \</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="preprocessor">            ((s2d*)mem)[NLAT_2-2 - (idx)*2] = _mm256_extractf128_pd(_mm256_shuffle_pd(ev-od, ev-od, 5), 1);</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="preprocessor">        #define S2D_CSTORE(mem, idx, er, or, ei, oi)    {   \</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="preprocessor">            rnd aa = (rnd)_mm256_shuffle_pd(ei+oi,ei+oi,5) + (er + or);     rnd bb = (er + or) - (rnd)_mm256_shuffle_pd(ei+oi,ei+oi,5); \</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="preprocessor">            _mm256_storeu_pd(((double*)mem) + (idx)*4, _mm256_shuffle_pd(bb, aa, 10 )); \</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="preprocessor">            _mm256_storeu_pd(((double*)mem) + (NPHI-2*im)*NLAT + (idx)*4, _mm256_shuffle_pd(aa, bb, 10 )); \</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="preprocessor">            aa = (rnd)_mm256_shuffle_pd(er-or,er-or,5) + (ei - oi);     bb = (rnd)_mm256_shuffle_pd(er-or,er-or,5) - (ei - oi); \</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="preprocessor">            ((s2d*)mem)[NLAT_2-1 -(idx)*2] = _mm256_castpd256_pd128(_mm256_shuffle_pd(bb, aa, 10 ));    \</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="preprocessor">            ((s2d*)mem)[NLAT_2-2 -(idx)*2] = _mm256_extractf128_pd(_mm256_shuffle_pd(bb, aa, 10 ), 1);  \</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="preprocessor">            ((s2d*)mem)[(NPHI+1-2*im)*NLAT_2 -1 -(idx)*2] = _mm256_castpd256_pd128(_mm256_shuffle_pd(aa, bb, 10 )); \</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="preprocessor">            ((s2d*)mem)[(NPHI+1-2*im)*NLAT_2 -2 -(idx)*2] = _mm256_extractf128_pd(_mm256_shuffle_pd(aa, bb, 10 ), 1);   }</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="preprocessor">        #define S2D_CSTORE2(mem, idx, er, or, ei, oi)   {   \</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="preprocessor">            rnd aa = (rnd)_mm256_unpacklo_pd(er+or, ei+oi); rnd bb = (rnd)_mm256_unpackhi_pd(er+or, ei+oi); \</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="preprocessor">            ((s2d*)mem)[(idx)*4]   = _mm256_castpd256_pd128(aa);    \</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="preprocessor">            ((s2d*)mem)[(idx)*4+1] = _mm256_castpd256_pd128(bb);    \</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="preprocessor">            ((s2d*)mem)[(idx)*4+2] = _mm256_extractf128_pd(aa, 1);  \</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="preprocessor">            ((s2d*)mem)[(idx)*4+3] = _mm256_extractf128_pd(bb, 1);  \</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="preprocessor">            aa = (rnd)_mm256_unpacklo_pd(er-or, ei-oi); bb = (rnd)_mm256_unpackhi_pd(er-or, ei-oi); \</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="preprocessor">            ((s2d*)mem)[NLAT-1-(idx)*4] = _mm256_castpd256_pd128(aa);   \</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="preprocessor">            ((s2d*)mem)[NLAT-2-(idx)*4] = _mm256_castpd256_pd128(bb);   \</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="preprocessor">            ((s2d*)mem)[NLAT-3-(idx)*4] = _mm256_extractf128_pd(aa, 1); \</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="preprocessor">            ((s2d*)mem)[NLAT-4-(idx)*4] = _mm256_extractf128_pd(bb, 1); }</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="preprocessor">    #else</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="preprocessor">        #define VSIZE2 2</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <span class="keyword">typedef</span> <span class="keywordtype">double</span> rnd __attribute__ ((vector_size (VSIZE2*8)));        <span class="comment">// vector of 2 doubles.</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="preprocessor">        #ifdef __SSE3__</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="preprocessor">            #include &lt;pmmintrin.h&gt;</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="preprocessor">            #define _SIMD_NAME_ &quot;sse3&quot;</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            <span class="keyword">inline</span> <span class="keyword">static</span> v2d v2d_reduce(v2d a, v2d b) {</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                <span class="keywordflow">return</span> _mm_hadd_pd(a,b);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="preprocessor">        #else</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="preprocessor">            #include &lt;emmintrin.h&gt;</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="preprocessor">            #define _SIMD_NAME_ &quot;sse2&quot;</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            <span class="keyword">inline</span> <span class="keyword">static</span> v2d v2d_reduce(v2d a, v2d b) {</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                v2d c = _mm_unpacklo_pd(a, b);      b = _mm_unpackhi_pd(a, b);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                <span class="keywordflow">return</span> b + c;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="preprocessor">        #define reduce_add(a) ( _mm_cvtsd_f64(a) + _mm_cvtsd_f64(_mm_unpackhi_pd(a,a)) )</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="preprocessor">        #define vall(x) ((rnd) _mm_set1_pd(x))</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="preprocessor">        #define vread(mem, idx) ((s2d*)mem)[idx]</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="preprocessor">        #define vstor(mem, idx, v) ((s2d*)mem)[idx] = v</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="preprocessor">        #define S2D_STORE(mem, idx, ev, od)     ((s2d*)mem)[idx] = ev+od;       ((s2d*)mem)[NLAT_2-1 - (idx)] = vxchg(ev-od);</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="preprocessor">        #define S2D_CSTORE(mem, idx, er, or, ei, oi)    {   \</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="preprocessor">            rnd aa = vxchg(ei + oi) + (er + or);        rnd bb = (er + or) - vxchg(ei + oi);    \</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="preprocessor">            ((s2d*)mem)[idx] = _mm_shuffle_pd(bb, aa, 2 );  \</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="preprocessor">            ((s2d*)mem)[(NPHI-2*im)*NLAT_2 + (idx)] = _mm_shuffle_pd(aa, bb, 2 );   \</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="preprocessor">            aa = vxchg(er - or) + (ei - oi);        bb = vxchg(er - or) - (ei - oi);    \</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="preprocessor">            ((s2d*)mem)[NLAT_2-1 -(idx)] = _mm_shuffle_pd(bb, aa, 2 );  \</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="preprocessor">            ((s2d*)mem)[(NPHI+1-2*im)*NLAT_2 -1 -(idx)] = _mm_shuffle_pd(aa, bb, 2 );   }</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="preprocessor">        #define S2D_CSTORE2(mem, idx, er, or, ei, oi)   {   \</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="preprocessor">            ((s2d*)mem)[(idx)*2]   = _mm_unpacklo_pd(er+or, ei+oi); \</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="preprocessor">            ((s2d*)mem)[(idx)*2+1] = _mm_unpackhi_pd(er+or, ei+oi); \</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="preprocessor">            ((s2d*)mem)[NLAT-1-(idx)*2] = _mm_unpacklo_pd(er-or, ei-oi);    \</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="preprocessor">            ((s2d*)mem)[NLAT-2-(idx)*2] = _mm_unpackhi_pd(er-or, ei-oi);    }</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="preprocessor">    #ifdef __SSE3__</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="preprocessor">        #define addi(a,b) _mm_addsub_pd(a, _mm_shuffle_pd(b,b,1))       // a + I*b</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="preprocessor">        #define subadd(a,b) _mm_addsub_pd(a, b)     // [al-bl, ah+bh]</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <span class="comment">//#define CMUL(a,b) _mm_addsub_pd(_mm_shuffle_pd(a,a,0)*b, _mm_shuffle_pd(a,a,3)*_mm_shuffle_pd(b,b,1))</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="preprocessor">    #else</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="preprocessor">        #define addi(a,b) ( (a) + (_mm_shuffle_pd(b,b,1) * _mm_set_pd(1.0, -1.0)) )     // a + I*b      [note: _mm_set_pd(imag, real)) ]</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="preprocessor">        #define subadd(a,b) ( (a) + (b) * _mm_set_pd(1.0, -1.0) )       // [al-bl, ah+bh]</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="comment">// build mask (-0, -0) to change sign of both hi and lo values using xorpd</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="preprocessor">    #define SIGN_MASK_2  _mm_castsi128_pd(_mm_slli_epi64(_mm_cmpeq_epi16(_mm_set1_epi64x(0), _mm_set1_epi64x(0)), 63))</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="comment">// build mask (0, -0) to change sign of hi value using xorpd (used in CFFT_TO_2REAL)</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="preprocessor">    #define SIGN_MASK_HI  _mm_unpackhi_pd(vdup(0.0), SIGN_MASK_2 )</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="comment">// build mask (-0, 0) to change sign of lo value using xorpd</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="preprocessor">    #define SIGN_MASK_LO  _mm_unpackhi_pd(SIGN_MASK_2, vdup(0.0) )</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="comment">// vset(lo, hi) takes two doubles and pack them in a vector</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="preprocessor">    #define vset(lo, hi) _mm_set_pd(hi, lo)</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="comment">// vdup(x) takes a double and duplicate it to a vector of 2 doubles.</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="preprocessor">    #define vdup(x) ((s2d)_mm_set1_pd(x))</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="comment">// vxchg(a) exchange hi and lo component of vector a</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="preprocessor">    #define vxchg(a) ((v2d)_mm_shuffle_pd(a,a,1))</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="preprocessor">    #define vlo_to_cplx(a) _mm_unpacklo_pd(a, vdup(0.0))</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="preprocessor">    #define vhi_to_cplx(a) _mm_unpackhi_pd(a, vdup(0.0))</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="preprocessor">    #define vcplx_real(a) vlo_to_dbl(a)</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="preprocessor">    #define vcplx_imag(a) vhi_to_dbl(a)</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="preprocessor">    #ifdef __clang__</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <span class="comment">// allow to compile with clang (llvm)</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="preprocessor">        #define vlo(a) (a)[0]</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="preprocessor">        #define vlo_to_dbl(a) (a)[0]</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="preprocessor">        #define vhi_to_dbl(a) (a)[1]</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="preprocessor">    #else</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="comment">// gcc extensions</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="preprocessor">        #ifdef __AVX__</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="preprocessor">            #define vlo(a) _mm_cvtsd_f64(_mm256_castpd256_pd128(a))</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="preprocessor">        #else</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="preprocessor">            #define vlo(a) _mm_cvtsd_f64(a)</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="preprocessor">        #define vlo_to_dbl(a) _mm_cvtsd_f64(a)</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="preprocessor">        #define vhi_to_dbl(a) _mm_cvtsd_f64(_mm_unpackhi_pd(a,a))</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="comment">// Allocate memory aligned on 16 bytes for SSE2 (fftw_malloc works only if fftw was compiled with --enable-sse2)</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="comment">// in 64 bit systems, malloc should be 16 bytes aligned anyway.</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="preprocessor">    #define VMALLOC(s)  ( (sizeof(void*) &gt;= 8) ? malloc(s) : _mm_malloc(s, MIN_ALIGNMENT) )</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="preprocessor">    #define VFREE(s)    ( (sizeof(void*) &gt;= 8) ? free(s) : _mm_free(s) )</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="preprocessor">#ifndef _GCC_VEC_</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="preprocessor">    #define MIN_ALIGNMENT 16</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="preprocessor">    #define VSIZE 1</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="preprocessor">    #define VSIZE2 1</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="preprocessor">    #define _SIMD_NAME_ &quot;scalar&quot;</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keyword">typedef</span> <span class="keywordtype">double</span> s2d;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structcomplex.html">complex</a> <span class="keywordtype">double</span> v2d;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keyword">typedef</span> <span class="keywordtype">double</span> rnd;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="preprocessor">    #define vread(mem, idx) ((double*)mem)[idx]</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="preprocessor">    #define vstor(mem, idx, v) ((double*)mem)[idx] = v;</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="preprocessor">    #define reduce_add(a) (a)</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="preprocessor">    #define v2d_reduce(a,b) ((a) +I*(b))    </span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="preprocessor">    #define vlo(a) (a)</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="preprocessor">    #define vall(x) (x)</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="preprocessor">    #define vdup(x) (x)</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="preprocessor">    #define vxchg(x) (x)</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="preprocessor">    #define addi(a,b) ((a) + I*(b))</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="preprocessor">    #define vlo_to_dbl(a) (a)</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="preprocessor">    #define vhi_to_dbl(a) (a)</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="preprocessor">    #define vcplx_real(a) creal(a)</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="preprocessor">    #define vcplx_imag(a) cimag(a)</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="comment">// allocate memory aligned for FFTW. In 64 bit systems, malloc should be 16 bytes aligned.</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="preprocessor">    #define VMALLOC(s)  ( (sizeof(void*) &gt;= 8) ? malloc(s) : fftw_malloc(s) )</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="preprocessor">    #define VFREE(s)    ( (sizeof(void*) &gt;= 8) ? free(s) : fftw_free(s) )</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="preprocessor">#define SSE __attribute__((aligned (MIN_ALIGNMENT)))</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="preprocessor">#define PTR_ALIGN(p) ((((size_t)(p)) + (MIN_ALIGNMENT-1)) &amp; (~((size_t)(MIN_ALIGNMENT-1))))</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div>
<div class="line"><a name="l00499"></a><span class="lineno"><a class="line" href="structDtDp.html">  499</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structDtDp.html">DtDp</a> {       <span class="comment">// theta and phi derivatives stored together.</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="keywordtype">double</span> t, p;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;};</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="preprocessor">#define GLUE2(a,b) a##b</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="preprocessor">#define GLUE3(a,b,c) a##b##c</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">// verbose printing</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="preprocessor">#if SHT_VERBOSE &gt; 1</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="preprocessor">  #define PRINT_VERB(msg) printf(msg)</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="preprocessor">  #define PRINT_VERB(msg) (0)</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div>
<div class="ttc" id="structshtns__info_html_a6e82a42d5e69391830bf5d7f085333f7"><div class="ttname"><a href="structshtns__info.html#a6e82a42d5e69391830bf5d7f085333f7">shtns_info::tm</a></div><div class="ttdeci">unsigned short * tm</div><div class="ttdoc">start theta value for SH (polar optimization : near the poles the legendre polynomials go to zero for...</div><div class="ttdef"><b>Definition:</b> sht_private.h:111</div></div>
<div class="ttc" id="shtns_8h_html_ab7bd78e5cbeb4ed18782d018195fde00"><div class="ttname"><a href="shtns_8h.html#ab7bd78e5cbeb4ed18782d018195fde00">shtns_cfg</a></div><div class="ttdeci">struct shtns_info * shtns_cfg</div><div class="ttdoc">pointer to data structure describing an SHT, returned by shtns_init() or shtns_create(). </div><div class="ttdef"><b>Definition:</b> shtns.h:41</div></div>
<div class="ttc" id="shtns_8h_html"><div class="ttname"><a href="shtns_8h.html">shtns.h</a></div><div class="ttdoc">shtns.h is the definition file for SHTns : include this file in your source code to use SHTns...</div></div>
<div class="ttc" id="structshtns__info_html_ad14521718bc234a2197e2d7bb91e0e81"><div class="ttname"><a href="structshtns__info.html#ad14521718bc234a2197e2d7bb91e0e81">shtns_info::lmidx</a></div><div class="ttdeci">int * lmidx</div><div class="ttdoc">(virtual) index in SH array of given im (size mmax+1) : LiM(l,im) = lmidx[im] + l ...</div><div class="ttdef"><b>Definition:</b> sht_private.h:102</div></div>
<div class="ttc" id="structshtns__info_html_afa549ef135b12b5060b2afecc1f9e660"><div class="ttname"><a href="structshtns__info.html#afa549ef135b12b5060b2afecc1f9e660">shtns_info::wg</a></div><div class="ttdeci">double * wg</div><div class="ttdoc">Gauss weights for Gauss-Legendre quadrature. </div><div class="ttdef"><b>Definition:</b> sht_private.h:114</div></div>
<div class="ttc" id="structshtns__info_html_a87e19b6bc65bf3d76cec4432d07bd3ff"><div class="ttname"><a href="structshtns__info.html#a87e19b6bc65bf3d76cec4432d07bd3ff">shtns_info::k_stride_a</a></div><div class="ttdeci">int k_stride_a</div><div class="ttdoc">stride in theta direction </div><div class="ttdef"><b>Definition:</b> sht_private.h:112</div></div>
<div class="ttc" id="structshtns__info_html_a646d0d38ed4bb1349d5cb5111b66e114"><div class="ttname"><a href="structshtns__info.html#a646d0d38ed4bb1349d5cb5111b66e114">shtns_info::st_1</a></div><div class="ttdeci">double * st_1</div><div class="ttdoc">1/sin(theta); </div><div class="ttdef"><b>Definition:</b> sht_private.h:115</div></div>
<div class="ttc" id="structshtns__info_html_a296b42387b5b60f6f4873a7024cd0d5d"><div class="ttname"><a href="structshtns__info.html#a296b42387b5b60f6f4873a7024cd0d5d">shtns_info::mi</a></div><div class="ttdeci">unsigned short * mi</div><div class="ttdoc">order m for given mode index (size nlm) : mi[lm] </div><div class="ttdef"><b>Definition:</b> sht_private.h:104</div></div>
<div class="ttc" id="structshtns__info_html_aed9bef40a200b6930120b84fa130c41a"><div class="ttname"><a href="structshtns__info.html#aed9bef40a200b6930120b84fa130c41a">shtns_info::nspat</a></div><div class="ttdeci">unsigned int nspat</div><div class="ttdoc">number of real numbers that must be allocated in a spatial field. </div><div class="ttdef"><b>Definition:</b> sht_private.h:106</div></div>
<div class="ttc" id="structshtns__info_html_a4e3a22a9dff6a9cf670fc007fb974a7c"><div class="ttname"><a href="structshtns__info.html#a4e3a22a9dff6a9cf670fc007fb974a7c">shtns_info::nphi</a></div><div class="ttdeci">unsigned short nphi</div><div class="ttdoc">number of spatial points in Phi direction (longitude) </div><div class="ttdef"><b>Definition:</b> sht_private.h:99</div></div>
<div class="ttc" id="structshtns__info_html_ae51719912d1a0c6ce672441e9931a574"><div class="ttname"><a href="structshtns__info.html#ae51719912d1a0c6ce672441e9931a574">shtns_info::li</a></div><div class="ttdeci">unsigned short * li</div><div class="ttdoc">degree l for given mode index (size nlm) : li[lm] </div><div class="ttdef"><b>Definition:</b> sht_private.h:103</div></div>
<div class="ttc" id="structshtns__info_html_a38cd0b51312d467b68c2de264b66997b"><div class="ttname"><a href="structshtns__info.html#a38cd0b51312d467b68c2de264b66997b">shtns_info::mmax</a></div><div class="ttdeci">unsigned short mmax</div><div class="ttdoc">maximum order (mmax*mres) of spherical harmonics. </div><div class="ttdef"><b>Definition:</b> sht_private.h:97</div></div>
<div class="ttc" id="structshtns__info_html_abd15108a5e4f0687f42a67b1b64a9a47"><div class="ttname"><a href="structshtns__info.html#abd15108a5e4f0687f42a67b1b64a9a47">shtns_info::nlm</a></div><div class="ttdeci">unsigned int nlm</div><div class="ttdoc">total number of (l,m) spherical harmonics components. </div><div class="ttdef"><b>Definition:</b> sht_private.h:95</div></div>
<div class="ttc" id="structshtns__info_html"><div class="ttname"><a href="structshtns__info.html">shtns_info</a></div><div class="ttdoc">structure containing useful information about the SHT. </div><div class="ttdef"><b>Definition:</b> sht_private.h:93</div></div>
<div class="ttc" id="structDtDp_html"><div class="ttname"><a href="structDtDp.html">DtDp</a></div><div class="ttdef"><b>Definition:</b> sht_private.h:499</div></div>
<div class="ttc" id="structshtns__info_html_aecf1d8b5744c247e04a0318136390a58"><div class="ttname"><a href="structshtns__info.html#aecf1d8b5744c247e04a0318136390a58">shtns_info::mres</a></div><div class="ttdeci">unsigned short mres</div><div class="ttdoc">the periodicity along the phi axis. </div><div class="ttdef"><b>Definition:</b> sht_private.h:98</div></div>
<div class="ttc" id="structshtns__info_html_a8a5c45a1fd2227abb668a3b3a4259509"><div class="ttname"><a href="structshtns__info.html#a8a5c45a1fd2227abb668a3b3a4259509">shtns_info::lmax</a></div><div class="ttdeci">unsigned short lmax</div><div class="ttdoc">maximum degree (lmax) of spherical harmonics. </div><div class="ttdef"><b>Definition:</b> sht_private.h:96</div></div>
<div class="ttc" id="structshtns__info_html_a30fd69b66eeb67e111ef1689bfb2d549"><div class="ttname"><a href="structshtns__info.html#a30fd69b66eeb67e111ef1689bfb2d549">shtns_info::ncplx_fft</a></div><div class="ttdeci">int ncplx_fft</div><div class="ttdoc">number of complex numbers to allocate for the fft : -1 = no fft; 0 = in-place fft (no allocation)...</div><div class="ttdef"><b>Definition:</b> sht_private.h:133</div></div>
<div class="ttc" id="structshtns__info_html_ae333643489525b49fd066ba7bb638696"><div class="ttname"><a href="structshtns__info.html#ae333643489525b49fd066ba7bb638696">shtns_info::nlat_2</a></div><div class="ttdeci">unsigned short nlat_2</div><div class="ttdoc">...and half of it (using (shtns.nlat+1)/2 allows odd shtns.nlat.) </div><div class="ttdef"><b>Definition:</b> sht_private.h:101</div></div>
<div class="ttc" id="structshtns__info_html_afacdb118d7b598332508ca8cfa914e15"><div class="ttname"><a href="structshtns__info.html#afacdb118d7b598332508ca8cfa914e15">shtns_info::mtr_dct</a></div><div class="ttdeci">short mtr_dct</div><div class="ttdoc">m truncation for dct. -1 means no dct at all. </div><div class="ttdef"><b>Definition:</b> sht_private.h:136</div></div>
<div class="ttc" id="structshtns__info_html_a2b76f5aee91ca7a93387d087ece0fd99"><div class="ttname"><a href="structshtns__info.html#a2b76f5aee91ca7a93387d087ece0fd99">shtns_info::fftc_mode</a></div><div class="ttdeci">short fftc_mode</div><div class="ttdoc">how to perform the complex fft : -1 = no fft; 0 = interleaved/native; 1 = split/transpose. </div><div class="ttdef"><b>Definition:</b> sht_private.h:109</div></div>
<div class="ttc" id="structshtns__info_html_a609589277af64939f7011b669147617b"><div class="ttname"><a href="structshtns__info.html#a609589277af64939f7011b669147617b">shtns_info::st</a></div><div class="ttdeci">double * st</div><div class="ttdoc">cos(theta) and sin(theta) arrays (size nlat) </div><div class="ttdef"><b>Definition:</b> sht_private.h:105</div></div>
<div class="ttc" id="structshtns__info_html_a12475937302f111720d59b8b11424215"><div class="ttname"><a href="structshtns__info.html#a12475937302f111720d59b8b11424215">shtns_info::nlat</a></div><div class="ttdeci">unsigned short nlat</div><div class="ttdoc">number of spatial points in Theta direction (latitude) ... </div><div class="ttdef"><b>Definition:</b> sht_private.h:100</div></div>
<div class="ttc" id="structshtns__info_html_a15f3351973710815ee68d0369e48dc43"><div class="ttname"><a href="structshtns__info.html#a15f3351973710815ee68d0369e48dc43">shtns_info::nthreads</a></div><div class="ttdeci">unsigned short nthreads</div><div class="ttdoc">number of threads (openmp). </div><div class="ttdef"><b>Definition:</b> sht_private.h:110</div></div>
<div class="ttc" id="structcomplex_html"><div class="ttname"><a href="structcomplex.html">complex</a></div><div class="ttdef"><b>Definition:</b> c_fft6.c:83</div></div>
<div class="ttc" id="structshtns__info_html_ad09115673d1275202501773f5a9f4875"><div class="ttname"><a href="structshtns__info.html#ad09115673d1275202501773f5a9f4875">shtns_info::klim</a></div><div class="ttdeci">unsigned short klim</div><div class="ttdoc">Limit to k for non-linear terms (dct) </div><div class="ttdef"><b>Definition:</b> sht_private.h:137</div></div>
<div class="ttc" id="structshtns__info_html_ac77e4275a0d03ef91cf9c9329eca6911"><div class="ttname"><a href="structshtns__info.html#ac77e4275a0d03ef91cf9c9329eca6911">shtns_info::m_stride_a</a></div><div class="ttdeci">int m_stride_a</div><div class="ttdoc">stride in phi direction (m) </div><div class="ttdef"><b>Definition:</b> sht_private.h:113</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
